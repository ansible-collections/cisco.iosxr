---
- debug: msg="START cli/comment.yaml on connection={{ ansible_connection }}"

- name: test commit confirmed functionality
  vars:
    ansible_iosxr_confirmed: True
    ansible_iosxr_timeout: 90
  cisco.iosxr.iosxr_config:
    lines:
      - hostname iosxr_commit_confirmed

- name: "get hostname"
  register: get_hostname1
  iosxr_command:
    commands:
      - "show running-config hostname"
  ignore_errors: True


- name: Sleep for 300 seconds and continue with play
  wait_for:
    timeout: 90

- name: "get hostname"
  register: get_hostname2
  iosxr_command:
    commands:
      - "show running-config hostname"
  ignore_errors: True


- assert:
    that:
      - "'iosxr_commit_confirmed' in get_hostname1"
      - "'iosxr_commit_confirmed' not in get_hostname1"
